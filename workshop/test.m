clear all
close all
clc
% General Settings
numImages = 6; % depends on the number of images you have
squareSize = 22; % in millimeters 
% Read files
files = cell(1, numImages);
for i = 1:numImages
 files{i} = fullfile(sprintf('./assign_files/Image%d.png', i)); 
end
% Display the image at working position
I = imread(files{2}); % assume image1 is the working position
% figure; imshow(I);
title('Image at Working Position');
% Detect the checkerboard corners in the images.
[imagePoints, boardSize] = detectCheckerboardPoints(files);
% Generate the world coordinates of the checkerboard corners in the
% pattern-centric coordinate system, with the upper-left corner at (0,0).

worldPoints = generateCheckerboardPoints(boardSize, squareSize);
% Calibrate the camera using Matlabâ€™s toolbox.
imageSize = [size(I, 1), size(I, 2)];
cameraParams = estimateCameraParameters(imagePoints, worldPoints, ...
 'ImageSize', imageSize)

matrix_test = [[0, 0, 0, 0.0, 0.0, 196.1062, 0, 0, -1], [0.0, 0.0, 228.8518, 0, 0, 0, 0, 0, -1], [0, 0, 0, 0.0, 5053.5144, 229.7052, 0, -22, -1], [0.0, 5076.9752, 230.7716, 0, 0, 0, 0, -22, -1], [0, 0, 0, 0.0, 11618.75, 264.0625, 0, -44, -1], [0.0, 10235.9488, 232.6352, 0, 0, 0, 0, -44, -1], [0, 0, 0, 0.0, 19733.874600000003, 298.9981, 0, -66, -1], [0.0, 15474.168599999999, 234.4571, 0, 0, 0, 0, -66, -1], [0, 0, 0, 0.0, 29450.537600000003, 334.6652, 0, -88, -1], [0.0, 20801.052799999998, 236.3756, 0, 0, 0, 0, -88, -1], [0, 0, 0, 0.0, 40800.089, 370.9099, 0, -110, -1], [0.0, 26206.686, 238.2426, 0, 0, 0, 0, -110, -1], [0, 0, 0, 4288.8823999999995, 0.0, 194.9492, -22, 0, -1], [5786.363, 0.0, 263.0165, 0, 0, 0, -22, 0, -1], [0, 0, 0, 5023.7066, 5023.7066, 228.3503, -22, -22, -1], [5833.5486, 5833.5486, 265.1613, 0, 0, 0, -22, -22, -1], [0, 0, 0, 5773.0772, 11546.1544, 262.4126, -22, -44, -1], [5880.0984, 11760.1968, 267.2772, 0, 0, 0, -22, -44, -1], [0, 0, 0, 6536.1274, 19608.3822, 297.0967, -22, -66, -1], [5927.2554, 17781.766200000002, 269.4207, 0, 0, 0, -22, -66, -1], [0, 0, 0, 7313.493, 29253.972, 332.4315, -22, -88, -1], [5977.0788, 23908.3152, 271.6854, 0, 0, 0, -22, -88, -1], [0, 0, 0, 8103.326000000001, 40516.630000000005, 368.333, -22, -110, -1], [6024.7660000000005, 30123.83, 273.853, 0, 0, 0, -22, -110, -1], [0, 0, 0, 8534.0332, 0.0, 193.9553, -44, 0, -1], [13049.9424, 0.0, 296.5896, 0, 0, 0, -44, 0, -1], [0, 0, 0, 9990.7896, 4995.3948, 227.0634, -44, -22, -1], [13152.7088, 6576.3544, 298.9252, 0, 0, 0, -44, -22, -1], [0, 0, 0, 11481.5008, 11481.5008, 260.9432, -44, -44, -1], [13255.3652, 13255.3652, 301.2583, 0, 0, 0, -44, -44, -1], [0, 0, 0, 12990.335599999999, 19485.503399999998, 295.2349, -44, -66, -1], [13365.792, 20048.688, 303.768, 0, 0, 0, -44, -66, -1], [0, 0, 0, 14531.2904, 29062.5808, 330.2566, -44, -88, -1], [13469.698, 26939.396, 306.1295, 0, 0, 0, -44, -88, -1], [0, 0, 0, 16100.440400000001, 40251.101, 365.9191, -44, -110, -1], [13581.0004, 33952.501000000004, 308.6591, 0, 0, 0, -44, -110, -1], [0, 0, 0, 12729.1296, 0.0, 192.8656, -66, 0, -1], [21759.9096, 0.0, 329.6956, 0, 0, 0, -66, 0, -1], [0, 0, 0, 14906.2716, 4968.7572, 225.8526, -66, -22, -1], [21928.467, 7309.4890000000005, 332.2495, 0, 0, 0, -66, -22, -1], [0, 0, 0, 17116.380599999997, 11410.920399999999, 259.3391, -66, -44, -1], [22099.4796, 14732.9864, 334.8406, 0, 0, 0, -66, -44, -1], [0, 0, 0, 19365.4692, 19365.4692, 293.4162, -66, -66, -1], [22278.3528, 22278.3528, 337.5508, 0, 0, 0, -66, -66, -1], [0, 0, 0, 21659.1738, 28878.898400000002, 328.1693, -66, -88, -1], [22454.968800000002, 29939.958400000003, 340.2268, 0, 0, 0, -66, -88, -1], [0, 0, 0, 23994.4188, 39990.698000000004, 363.5518, -66, -110, -1], [22634.5614, 37724.269, 342.9479, 0, 0, 0, -66, -110, -1], [0, 0, 0, 16886.3464, 0.0, 191.8903, -88, 0, -1], [31874.3304, 0.0, 362.2083, 0, 0, 0, -88, 0, -1], [0, 0, 0, 19773.6, 4943.4, 224.7, -88, -22, -1], [32120.0, 8030.0, 365.0, 0, 0, 0, -88, -22, -1], [0, 0, 0, 22694.091200000003, 11347.045600000001, 257.8874, -88, -44, -1], [32373.748000000003, 16186.874000000002, 367.8835, 0, 0, 0, -88, -44, -1], [0, 0, 0, 25670.216, 19252.662, 291.707, -88, -66, -1], [32632.8904, 24474.6678, 370.8283, 0, 0, 0, -88, -66, -1], [0, 0, 0, 28697.987999999998, 28697.987999999998, 326.1135, -88, -88, -1], [32885.5648, 32885.5648, 373.6996, 0, 0, 0, -88, -88, -1], [0, 0, 0, 31785.8376, 39732.297, 361.2027, -88, -110, -1], [33146.3704, 41432.962999999996, 376.6633, 0, 0, 0, -88, -110, -1], [0, 0, 0, 21007.459, 0.0, 190.9769, -110, 0, -1], [43362.594, 0.0, 394.2054, 0, 0, 0, -110, 0, -1], [0, 0, 0, 24567.708000000002, 4913.5416000000005, 223.3428, -110, -22, -1], [43690.702, 8738.1404, 397.1882, 0, 0, 0, -110, -22, -1], [0, 0, 0, 28197.124999999996, 11278.849999999999, 256.3375, -110, -44, -1], [44037.708, 17615.0832, 400.3428, 0, 0, 0, -110, -44, -1], [0, 0, 0, 31895.346999999998, 19137.2082, 289.9577, -110, -66, -1], [44372.834, 26623.7004, 403.3894, 0, 0, 0, -110, -66, -1], [0, 0, 0, 35653.497, 28522.7976, 324.1227, -110, -88, -1], [44729.674, 35783.739199999996, 406.6334, 0, 0, 0, -110, -88, -1], [0, 0, 0, 39482.696, 39482.696, 358.9336, -110, -110, -1], [45076.306000000004, 45076.306000000004, 409.7846, 0, 0, 0, -110, -110, -1], [0, 0, 0, 25086.4416, 0.0, 190.0488, -132, 0, -1], [56208.1872, 0.0, 425.8196, 0, 0, 0, -132, 0, -1], [0, 0, 0, 29333.1984, 4888.8664, 222.2212, -132, -22, -1], [56642.124, 9440.354000000001, 429.107, 0, 0, 0, -132, -22, -1], [0, 0, 0, 33653.07, 11217.689999999999, 254.9475, -132, -44, -1], [57071.520000000004, 19023.84, 432.36, 0, 0, 0, -132, -44, -1], [0, 0, 0, 38050.4256, 19025.2128, 288.2608, -132, -66, -1], [57514.8156, 28757.4078, 435.7183, 0, 0, 0, -132, -66, -1], [0, 0, 0, 42529.3704, 28352.9136, 322.1922, -132, -88, -1], [57944.251200000006, 38629.5008, 438.9716, 0, 0, 0, -132, -88, -1], [0, 0, 0, 47095.765199999994, 39246.471, 356.7861, -132, -110, -1], [58401.5388, 48667.949, 442.4359, 0, 0, 0, -132, -110, -1], [0, 0, 0, 29133.412, 0.0, 189.178, -154, 0, -1], [70365.8494, 0.0, 456.9211, 0, 0, 0, -154, 0, -1], [0, 0, 0, 34045.842599999996, 4863.6918, 221.0769, -154, -22, -1], [70890.5582, 10127.222600000001, 460.3283, 0, 0, 0, -154, -22, -1], [0, 0, 0, 39064.117399999996, 11161.1764, 253.6631, -154, -44, -1], [71425.01520000001, 20407.1472, 463.7988, 0, 0, 0, -154, -44, -1], [0, 0, 0, 44148.6276, 18920.8404, 286.6794, -154, -66, -1], [71973.286, 30845.694, 467.359, 0, 0, 0, -154, -66, -1], [0, 0, 0, 49325.2606, 28185.8632, 320.2939, -154, -88, -1], [72532.075, 41446.9, 470.9875, 0, 0, 0, -154, -88, -1], [0, 0, 0, 54614.483, 39010.345, 354.6395, -154, -110, -1], [73091.326, 52208.090000000004, 474.619, 0, 0, 0, -154, -110, -1], [0, 0, 0, 33137.5968, 0.0, 188.2818, -176, 0, -1], [85823.7072, 0.0, 487.6347, 0, 0, 0, -176, 0, -1], [0, 0, 0, 38740.240000000005, 4842.530000000001, 220.115, -176, -22, -1], [86452.4672, 10806.5584, 491.2072, 0, 0, 0, -176, -22, -1], [0, 0, 0, 44403.8848, 11100.9712, 252.2948, -176, -44, -1], [87103.3152, 21775.8288, 494.9052, 0, 0, 0, -176, -44, -1], [0, 0, 0, 50188.4944, 18820.6854, 285.1619, -176, -66, -1], [87783.1328, 32918.6748, 498.7678, 0, 0, 0, -176, -66, -1], [0, 0, 0, 56088.0496, 28044.0248, 318.6821, -176, -88, -1], [88422.0656, 44211.0328, 502.3981, 0, 0, 0, -176, -88, -1], [0, 0, 0, 62072.472, 38795.295, 352.6845, -176, -110, -1], [89122.42240000001, 55701.514, 506.3774, 0, 0, 0, -176, -110, -1]];
[U,S,V] = svd(matrix_test)
